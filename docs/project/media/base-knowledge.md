# 视频流媒体知识

> 流媒体（Streaming Media）服务是指一连串数据压缩后，经过网络分段发送，即时传输以供观看音视频的一种技术。

最近在做一些关于音视频相关的内容，起初对视频相关背景知识不甚了解，因此学习了一下相关知识，整理如下：

- 视频编码协议
- 媒体传输协议
- 视频播放器

## 视频编码协议

视频编码方式就是指通过压缩技术，将原始视频格式的文件转换成另一种视频格式文件的方式，目前最重要的编解码标准有 H.26X 系列、MPEG 系列、AVS。

1. H.26x 系列
   - H.26X 系列由国际电传视讯联盟主导，主要包括 H.264、H.265 等，主要应用于实时视频通信领域，如视频会议。
   - H.264， 支持无损压缩和有损压缩，支持的最大分辨率是 4096x2048（4K）；
   - H.265，相比 H.264 体积减少 50%，最大分辨率 8192x4320（8K）。
2. MPEG 系列
   - MPEG 系列由 ISO（国际标准组织机构）下属的 MPEG 开发，主要包括主要应用监控摄像、高清电视广播和及 DVD。
3. AVS
   - AVS 视频编码标准是中国 AVS 工作组制定的第三代标准，主要用于超高清电视广播、虚拟现实和视频监控。

## 流媒体传输协议

流媒体传输协议是一种标准化的传递方法，用于将视频分解为多个块，将其发送给视频播放器，播放器重新组合播放。

常见的直播流协议有：RTMP、RTSP、HTTP 等；常见的点播协议有：MP4、FLV、HLS 等。RTMP、RTSP 和 HTTP 一样，在网络 7 层协议中属于应用层。

1. RTMP

   - RTMP 即 Real-Time Messaging Protocol(实时消息传送协议)，包括 RTMPT/RTMPS/RTMPE 等多种变种，主要用来在 Flash/AIR 平台和支持 RTMP 协议的流媒体/交互服务器之间进行音视频和数据通信，其特点是延时较小，基于 TCP 长连接，不需要多次建连。

2. RTSP

   - RTSP 即 Real-Time Streaming Protocol(实时流传送协议)，主要作用包括：1、获取资源的描述信息；2、协商媒体传输方式；3、流的播放控制。RTSP 协议和 HTTP 格式相同，可以使用标准 HTTP 解析器来解析。

3. HTTP-FLV

   - HTTP-FLV 即音视频数据封装成 FLV(FLASH VIDEO)，然后通过 HTTP 协议传输给客户端，属于国内直播主要传输协议。延迟角度来看，HTTP-FLV 要优于 RTMP，以 80http 通信的，极好的穿透性。

4. HLS

   - HLS 即 HTTP Live Streaming，基于 HTTP 的流媒体传输协议，是 Apple 公司推出的标准。其工作原理是把整个流切分成一片片小的基于 HTTP 的文件来下载，目前各种手机浏览器产品对这种格式的兼容性也最好，允许用户从不同的备用源以不同的速率下载同样的资源片段，允许流媒体会话适应不同的数据速率。HLS 清单称为播放列表，格式为 m3u8（它们是 m3u 播放列表文件，以 UTF-8 编码），缺点是延迟比较大，一般是 20s - 30s 左右的延迟。

     ![img](https://pica.zhimg.com/80/v2-033be5ec59066f89392114d64695cbb4_720w.jpg?source=1940ef5c)

## 视频播放器

视频播放互联网视频文件需要以下步骤：

- 解协议
- 解封装
- 解码视音频
- 视音频同步
